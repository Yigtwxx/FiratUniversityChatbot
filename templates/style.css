:root{
  --bg:#0a0f1c;
  --panel:#0b1324;
  --panel-2:#091225;
  --muted:#9fb0c6;
  --text:#f3f4f6;
  --accent:#7c8cff;
  --accent-2:#60a5fa;
  --ok:#10b981;
  --no:#ef4444;
  --bubble-user:#162238;
  --bubble-bot:#0a0f1c;
  --border:rgba(148,163,184,.16);
  --shadow:0 10px 30px rgba(0,0,0,.40);
  --radius:18px;
  --bg-dot: rgba(160, 140, 255, .95);
  --bg-line: rgba(120, 170, 255, .28);
  --bg-glow: 150, 170, 255;
  --bg-fade: 0.075;
  --vh: 1vh;
  --topbarH: 60px;
  --composerH: 90px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(90vw 90vh at 15% -10%, rgba(124,140,255,.12), transparent 55%),
    radial-gradient(80vw 70vh at 110% 15%, rgba(96,165,250,.10), transparent 55%),
    radial-gradient(120vw 110vh at -10% 110%, rgba(56, 0, 80,.08), transparent 55%),
    var(--bg);
  color:var(--text);
  font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, system-ui, "Apple Color Emoji","Segoe UI Emoji";
  letter-spacing:.2px;
  -webkit-text-size-adjust:100%;
  -webkit-tap-highlight-color: transparent;
  overscroll-behavior: none;
  touch-action: manipulation;
}
#cosmic-bg{ position:fixed; inset:0; z-index:-1; pointer-events:none; }
#cosmic-bg canvas{ display: block; width: 100%; height: 100%; }
#cosmic-bg::before{
  content:""; position:absolute; inset:0; mix-blend-mode:screen;
  background:
    radial-gradient(1100px 700px at 20% 18%, rgba(255,255,255,.04), transparent 60%),
    radial-gradient(1000px 700px at 82% 85%, rgba(120,120,255,.05), transparent 55%),
    radial-gradient(1200px 900px at 60% 40%, rgba(0,0,0,.18), transparent 60%);
  opacity:.9;
}
@media (prefers-reduced-motion: reduce) { #cosmic-bg { display:none; } }
.topbar{
  position:sticky; top:0; z-index:5;
  background:linear-gradient(90deg, rgba(9,18,36,.80), rgba(5,10,24,.80));
  border-bottom:1px solid var(--border);
  backdrop-filter:saturate(140%) blur(10px);
  -webkit-backdrop-filter:saturate(140%) blur(10px);
}
.hambox{ position:absolute; left:12px; top:50%; transform:translateY(-50%); z-index:6; }
.hamburger{
  appearance:none; background:transparent; border:none; padding:0; margin:0;
  width:30px; height:22px; display:inline-grid; gap:6px;
  cursor:pointer; opacity:.9; transition:.15s opacity,.15s transform;
  -webkit-tap-highlight-color: transparent; outline: none;
}
.hamburger:hover{ opacity:1; transform:translateY(-1px) }
.hamburger:active{ transform:scale(.98) }
.hamburger:focus-visible{ box-shadow:0 0 0 3px rgba(124,140,255,.15); border-radius:6px; }
.hamburger span{ height:2px; border-radius:2px; background:#ffffff; }
.topwrap{
  position:relative; max-width:1100px; margin:0 auto;
  padding:14px 18px 14px 56px;
  display:flex; align-items:center; gap:12px;
}
.brand{ display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit; }
.logo{
  width:30px; height:30px; display:block; object-fit:contain;
  border-radius:8px; background:transparent;
  box-shadow:0 0 0 1px var(--border), 0 2px 10px rgba(0,0,0,.25);
}
.title{font-weight:800; letter-spacing:.3px}
.live{margin-left:auto; display:flex; align-items:center; gap:8px}
.live .pill{font-size:12px; padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:linear-gradient(180deg, #0c152b, #0a1122)}
.page{max-width:1100px; margin:24px auto; padding:0 18px; display:grid; grid-template-columns: 1fr; gap:16px}
@media(min-width:980px){ .page{grid-template-columns: 300px 1fr} }
.side{position:sticky; top: calc(var(--topbarH, 60px) + 24px); align-self:start; display:flex; flex-direction:column; gap:14px}
.card{
  background: linear-gradient(180deg, rgba(11,19,36,.86), rgba(9,18,37,.82));
  border:1px solid var(--border); border-radius:var(--radius);
  box-shadow:var(--shadow);
  backdrop-filter: blur(6px) saturate(120%);
  -webkit-backdrop-filter: blur(6px) saturate(120%);
}
.card .hd{padding:14px 16px; border-bottom:1px solid var(--border); font-weight:700; display:flex; align-items:center; gap:10px}
.card .bd{padding:14px 16px}
.quick{display:flex; flex-wrap:wrap; gap:10px}
.chip{
  border:1px solid var(--border); color:var(--text);
  background:linear-gradient(180deg, rgba(18,28,56,.85), rgba(12,20,42,.65));
  padding:10px 14px; border-radius:12px; cursor:pointer;
  transition:.18s transform, .18s box-shadow, .18s background;
  box-shadow:0 6px 16px rgba(100,120,255,.12); font: inherit;
}
.chip:hover{transform:translateY(-1px); box-shadow:0 8px 20px rgba(100,120,255,.18)}
.muted-text { color: var(--muted); font-size: 12px; margin-top: 10px; line-height: 1.5; }
.small-text { font-size: 14px; }
.chat-section { display: flex; flex-direction: column; min-height: 70vh; }
.chat-bd { padding: 0; flex-grow: 1; display: flex; flex-direction: column; }
.chatwrap{
  flex-grow: 1; overflow-y:auto; padding:18px;
  border-bottom:1px solid var(--border); scroll-behavior:smooth;
  overscroll-behavior:contain; -webkit-overflow-scrolling:touch; contain:layout paint;
  touch-action: pan-y; min-height: 300px;
}
.chat{display:flex; flex-direction:column; gap:14px}
.msg{display:grid; grid-template-columns:40px 1fr; gap:12px; align-items:flex-start}
.msg .avatar{width:40px; height:40px; border-radius:12px; display:grid; place-items:center; background:#0f1a33; border:1px solid var(--border); flex-shrink: 0;}
.msg .bubble{border:1px solid var(--border); border-radius:16px; padding:12px 14px; line-height:1.65; box-shadow:var(--shadow); word-wrap: break-word; overflow-wrap: break-word;}
.from-user{grid-template-columns:1fr 40px}
.from-user .avatar{order:2}
.from-user .bubble{order:1; justify-self:end; background:linear-gradient(180deg, var(--bubble-user), #0b1731)}
.from-bot .bubble{background:linear-gradient(180deg, var(--bubble-bot), #0a1328)}
.srcs{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
.src{font-size:12px; padding:6px 10px; border:1px dashed var(--border); border-radius:999px; color:#d7e0f3; background:rgba(10,16,32,.35)}
.actions{display:flex; gap:10px; margin-top:10px}
.btn{
  display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px;
  border:1px solid var(--border); background:linear-gradient(180deg, #0d1a34, #0a1328);
  cursor:pointer; font-weight:700; color: var(--text); font: inherit;
}
.btn .dot{width:10px;height:10px;border-radius:50%}
.btn.ok .dot{background:radial-gradient(circle at 30% 30%, #c7d2fe, var(--accent))}
.btn.no .dot{background:radial-gradient(circle at 30% 30%, #fecaca, var(--no))}
.btn:disabled{opacity:.6; cursor:not-allowed}
.btn.ok{border-color:rgba(124,140,255,.4); background:linear-gradient(180deg, rgba(124,140,255,.22), rgba(124,140,255,.08)); color:#eef2ff;}
.btn.no{border-color:rgba(239,68,68,.35); background:linear-gradient(180deg, rgba(239,68,68,.18), rgba(239,68,68,.06)); color:#ffe4e6;}
.btn.ok.active{background:linear-gradient(180deg,#7c8cff,#6366f1); color:#0b1020; border-color:#7c8cff}
.btn.no.active{background:linear-gradient(180deg,#ef4444,#b91c1c); color:#2b0b0b; border-color:#ef4444}
.composer{display:grid; grid-template-columns:1fr auto; gap:10px; align-items:end; padding:12px 18px; border-top: 1px solid var(--border);}
.input{display:flex; background:linear-gradient(180deg, var(--panel), var(--panel-2)); border:1px solid var(--border); border-radius:var(--radius); padding:12px; box-shadow:var(--shadow)}
textarea{
  flex:1; resize:none; border:0; outline:none; background:transparent; color:var(--text);
  font-size:15px; line-height:1.55; font: inherit;
  max-height: calc(1.55em * 6 + 24px); min-height: calc(1.55em + 24px);
}
.send{
  padding:14px 18px; border-radius:12px; border:1px solid rgba(124,140,255,.45);
  color:#0b1020; background:linear-gradient(90deg, var(--accent), var(--accent-2));
  font-weight:800; letter-spacing:.2px; cursor:pointer;
  box-shadow:0 6px 22px rgba(96,165,250,.35); font: inherit;
  height: calc(1.55em + 28px);
}
.send[disabled]{opacity:.6; cursor:not-allowed}
.skeleton{border-radius:12px; height:14px; background:linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.12), rgba(255,255,255,.06)); background-size:200% 100%; animation:shimmer 1.2s infinite}
@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
code, pre{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:13px}
pre{white-space:pre-wrap; margin:8px 0 0; background: rgba(0,0,0,0.2); padding: 8px; border-radius: 8px; border: 1px solid var(--border);}
a{color:#a7b7ff}
.safe-bottom{height:env(safe-area-inset-bottom, 0)}
@media(max-width:980px){
  .page{grid-template-columns:1fr; gap:12px; margin:10px auto; padding:0 10px}
  .side{display:none}
  .card{border-radius:16px}
  .chatwrap{
    border:0; padding:12px 10px 6px;
    height:calc(var(--vh, 1vh) * 100 - var(--topbarH, 60px) - var(--composerH, 90px) - env(safe-area-inset-bottom, 0px));
    max-height:calc(var(--vh, 1vh) * 100 - var(--topbarH, 60px) - var(--composerH, 90px) - env(safe-area-inset-bottom, 0px));
  }
  .composer{
    position:sticky; bottom:0;
    background:linear-gradient(180deg, rgba(2,6,23,.6), rgba(2,6,23,.95));
    backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px);
    padding:10px 12px; border-top: 0;
  }
  .input{padding:10px; border-radius: 16px;}
  textarea{font-size:16px; min-height: calc(1.55em + 20px); max-height: calc(1.55em * 6 + 20px);}
  .send{padding:12px 14px; height: calc(1.55em + 24px);}
  .topwrap{ padding:10px 12px 10px 56px; }
  .logo{ width:28px; height:28px; }
}
.chipsbar{
  position:fixed; left:0; right:0;
  bottom:calc(var(--composerH, 90px) + env(safe-area-inset-bottom, 0px) + 6px);
  z-index:6; padding:6px 8px; display:none;
}
@media(max-width:980px){ .chipsbar{display:block} }
.chipsbar .rail{
  display:flex; gap:8px; overflow-x:auto; -webkit-overflow-scrolling:touch;
  padding:6px 8px; border-radius:14px;
  background:linear-gradient(180deg, rgba(8,14,32,.75), rgba(8,14,32,.45));
  border:1px solid var(--border); box-shadow:var(--shadow);
  scrollbar-width: none;
}
.chipsbar .rail::-webkit-scrollbar{display:none}
.chipsbar .chip{white-space:nowrap; padding:10px 12px; flex-shrink: 0;}
.fab{
  position:fixed; right:14px;
  bottom:calc(var(--composerH, 90px) + env(safe-area-inset-bottom, 0px) + 56px);
  width:46px; height:46px; border-radius:50%; display:grid; place-items:center;
  border:1px solid var(--border); background:linear-gradient(180deg,#0c1628,#0b1220);
  box-shadow:0 10px 24px rgba(0,0,0,.35); opacity:0; pointer-events:none;
  transition:opacity .2s ease; cursor:pointer; color: var(--text); font-size: 1.2em;
  -webkit-tap-highlight-color: transparent; padding: 0;
}
.fab.show{opacity:1; pointer-events:auto}
.toast{
  position:fixed; left:50%; bottom:calc(var(--composerH, 90px) + env(safe-area-inset-bottom, 0px) + 8px);
  transform:translateX(-50%);
  background:#0b1220; color:#e8ecff; border:1px solid var(--border);
  padding:10px 14px; border-radius:12px; box-shadow:var(--shadow);
  opacity:0; transition:opacity .2s ease, transform .2s ease; z-index:7;
  pointer-events: none;
}
.toast.show{opacity:1; transform:translateX(-50%) translateY(-6px)}
.drawer{
  position:fixed; inset:0 auto 0 0; width:260px; max-width:80%;
  transform:translateX(-105%); transition:transform .22s ease-out;
  background: linear-gradient(180deg, rgba(11, 19, 36, .90), rgba(9, 18, 37, .85));
  border-right:1px solid var(--border); box-shadow:var(--shadow);
  z-index:20; display:flex; flex-direction:column;
  backdrop-filter: blur(8px) saturate(130%);
  -webkit-backdrop-filter: blur(8px) saturate(130%);
}
.drawer.open{ transform:translateX(0) }
.drawer .dw-hd{ padding:14px 16px; border-bottom:1px solid var(--border); font-weight:800; letter-spacing:.3px }
.drawer .dw-bd{ padding:10px 8px; display:flex; flex-direction:column; gap:8px }
.drawer .item{
  display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px;
  border:1px solid var(--border); background:linear-gradient(180deg,#0c162a,#0a1222);
  color:var(--text); cursor:pointer; font-weight:600; font: inherit; text-align: left;
}
.drawer .item:hover{ background:linear-gradient(180deg,#0e1a30,#0b1426) }
.backdrop{
  position:fixed; inset:0; background:rgba(2,8,23,.45);
  backdrop-filter:blur(2px); -webkit-backdrop-filter: blur(2px);
  opacity:0; pointer-events:none; transition:opacity .16s ease-out; z-index:19;
}
.backdrop.show{ opacity:1; pointer-events:auto }
